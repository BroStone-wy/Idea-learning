# 多配体同时对接数据集构造方案（最终完整版）

## 总结（结论一句话）
**训练集**：用 LP-PDBBind 的同靶多配体组合 + 「AutoDock Vina 1.2 / Moldina」产出的同时对接伪标注（PoseBusters 过滤）做大规模监督；  
**验证集**：小而精的真实共晶多配体体系 + 少量组合样本；  
**测试集**：① 真实共晶多配体集；② CrossDocked-OOD 组合集；③ PanDDA/Fragalysis 片段共现难例集；  
并统一报告 **RMSD≤2 Å / PoseBusters 合法率 / 配体–配体冲突率 / EF1%**。  

---

## 训练集（Train）

### 规模目标（可落地）
- 多配体组合样本：**12k–20k** 条（以 N=2/3 为主；正负样本比例≈1:1）。  
- 覆盖蛋白数量：≥**2,000** 个 UniProt 靶标，避免集中在少数蛋白家族。  

### 来源与构造方法
1. **基座数据**  
   - 使用 **LP-PDBBind（Leak-Proof PDBBind）** 作为基础，确保严格的防泄漏划分（蛋白序列/结构 + 配体骨架相似度双约束）。  
   - 参考文献：【LP-PDBBind】  

2. **同靶分组与坐标统一**  
   - 按 **UniProt** 聚合同一靶标的多个配体。  
   - 使用 **Kabsch 刚体对齐**对 binding-site 进行坐标统一。  
   - 参考文献：【GroupBind】（ICLR 2025，提供同靶分组 + 对齐的思路）  

3. **口袋状态一致性过滤**  
   - 口袋 Cα-RMSD < **1.2 Å**；  
   - 或残基接触指纹相似度 ≥**0.7**；  
   - 仅保留分辨率 ≤**2.8 Å** 且配体占有率 ≥**0.5** 的结构。  

4. **伪标注生成（Teacher）**  
   - 使用 **AutoDock Vina 1.2** 的“multiple ligands docking”模式，或 **Moldina**（Vina 的加速版多配体搜索算法），对同靶组合进行**同时对接**。  
   - 每个组合保留 1–3 个联合候选姿势。  
   - 参考文献：【Vina 1.2】，【Moldina】  

5. **几何/化学合法性过滤**  
   - 使用 **PoseBusters** 检查 teacher 生成的联合姿势；仅保留通过合法性验证的候选：  
     - 键长、键角、平面性合格；  
     - 无蛋白–配体穿插或过短接触。  
   - 参考文献：【PoseBusters】  

6. **负样本构造**  
   - 从同靶配体库按骨架多样性采样组合。  
   - 判定规则：若配体–配体最近原子距离  
     \[
     d_{\min} < 0.6 \times (r_i^{\text{vdW}} + r_j^{\text{vdW}})
     \]  
     → 标记为“冲突组合”，作为负例参与训练。  
   - 该规则与 PoseBusters 的物理合法性检查一致。  

---

## 验证集（Validation）

### 规模目标
- **600–800** 条多配体组合样本。  

### 构成
1. **真实共晶多配体（核心验证集）**  
   - 使用 **Moldina** 文中提供的 10 个 PDB 体系（如 *5X72, 3HZ1, 2QFO* 等），这些体系确实存在同时多配体结合的情况。  
   - 参考文献：【Moldina】  

2. **组合样本补充**  
   - 从 LP-PDBBind 的验证划分中抽取 ~500 条组合样本，保证家族多样性。  

3. **早期 OOD 小检查**  
   - 从 **CrossDocked2020** 中采样 **100–200** 条跨骨架/跨家族的组合，做泛化预检。  
   - 参考文献：【CrossDocked】  

### 指标
- 每配体 Top-1 / Top-5 RMSD ≤ 2 Å 成功率。  
- PoseBusters 合法率。  
- 配体–配体冲突率。

---

## 测试集（Test）

### 总规模目标
- **2,000–2,500** 条多配体组合。  

### 构成
1. **真实共晶多配体集（Strong Supervision Test）**  
   - 来源：Moldina 提供的体系 + PDB 检索扩展。  
   - 筛选规则：  
     - 任意两配体重心距离 < **12 Å**；  
     - 各自 6 Å 壳层的接触残基集合有 ≥**3** 个残基重叠。  
   - 规模：**50–100** 条组合。  

2. **CrossDocked-OOD 组合集（泛化主测试）**  
   - 来源：CrossDocked2020（22.5M cross-docking poses）。  
   - 构造方式：跨骨架 / 跨家族组合，同靶配体统一对齐。  
   - 规模：**1,200–1,800** 条组合。  
   - 参考文献：【CrossDocked2020】  

3. **PanDDA/Fragalysis 片段共现难例集**  
   - 来源：**PanDDA**（多数据集事件检测）与 **Fragalysis/XChem** 项目。  
   - 筛选：同一事件簇或同一晶体模型中共存的 2–3 个片段。  
   - 规模：**100–200** 条组合，代表高拥挤/窄通道的难例。  
   - 参考文献：【PanDDA/Fragalysis】  

---

## 统一评测标准
1. **姿势准确性**：每配体 Top-1 / Top-5 RMSD ≤ 2 Å。  
2. **几何/化学合法性**：PoseBusters 全套检查（键长、键角、平面性、穿插、排斥） + ligand–ligand 冲突率。  
3. **虚拟筛选效果**：早期富集指标 EF1%（推荐在 DUD-E / DEKOIS 2.0 数据集上报告）。  
   - 参考文献：【DUD-E / DEKOIS】  
4. **泛化能力**：分别在 ID 与 OOD 上报告（CrossDocked 提供 OOD）。  

---

## 可复刻基线
- **传统基线**：AutoDock Vina 1.2（multi-ligands 模式）；Moldina（J. Cheminf. 2025，开源代码）。  
- **对照模型**：GroupBind（多配体信息共享，不是同时 docking，用作“非同时”对照）。  

---

## 关键参考文献
- **Moldina**（J. Cheminf. 2025）：多配体同时对接工具与公开体系示例。  
- **AutoDock Vina 1.2**：官方支持“multiple ligands docking”。  
- **GroupBind**（ICLR 2025）：多配体分组与对齐的思路。  
- **CrossDocked2020**：22.5M cross-docking 数据集，用于 OOD。  
- **LP-PDBBind（Leak-Proof）**：防泄漏拆分原则与仓库。  
- **PoseBusters**（2023/2024）：几何/化学一致性检查工具。  
- **DUD-E, DEKOIS 2.0**：虚拟筛选早期富集基准。  
- **PanDDA/Fragalysis/XChem**：片段共现数据与方法学。
